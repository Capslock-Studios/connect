<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsNext Data Test</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { max-width: 800px; margin: auto; padding: 20px; }
        .data-section { margin-bottom: 20px; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 5px; }

        /* Header and Navigation */
        header {
            background: #333;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav ul {
            list-style: none;
            display: flex;
        }
        nav ul li {
            margin: 0 15px;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            transition: 0.3s;
        }
        nav ul li a:hover {
            background: #555;
            border-radius: 5px;
        }
    </style>

    <!-- Define API URL globally -->
    <script>
        window.API_URL = "https://dbconn-b837.onrender.com/api"; 
    </script>
</head>
<body>

<header>
    <h1>My Site</h1>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/models/user.html">User</a></li>
            <li><a href="/models/company.html">Company</a></li>
            <li><a href="/models/product.html">Product</a></li>
        </ul>
    </nav>
</header>

<div class="container">
    <h1>WhatsNext Data Test</h1>

    <div class="data-section">
        <h2>Users</h2>
        <pre id="users">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Companies</h2>
        <pre id="companies">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Posts</h2>
        <pre id="posts">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Products</h2>
        <pre id="products">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Savvys</h2>
        <pre id="savvys">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Petitions</h2>
        <pre id="petitions">Loading...</pre>
    </div>
    <div class="data-section">
        <h2>Click Tracking</h2>
        <pre id="clickTracking">Loading...</pre>
    </div>
</div>

<!-- Fetch API Data -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const apiBaseUrl = window.API_URL; // Uses dynamic API URL

        async function fetchData(endpoint, elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;

            try {
                let response = await fetch(`${apiBaseUrl}/${endpoint}`);
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

                let data = await response.json();
                element.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                element.textContent = "❌ Error fetching data.";
                console.error(`❌ Error fetching ${endpoint}:`, error);
            }
        }

        // Fetch all data
        fetchData("users", "users");
        fetchData("companies", "companies");
        fetchData("posts", "posts");
        fetchData("products", "products");
        fetchData("savvys", "savvys");
        fetchData("petitions", "petitions");
        fetchData("click-tracking", "clickTracking");
    });
</script>

<script src="script.js"></script>

</body>
</html>
